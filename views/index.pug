title Statistics Report
head
    meta(charset='UTF-8')
    meta(name='viewport', content='width=device-width, initial-scale=1.0')
    meta(http-equiv='X-UA-Compatible', content='ie=edge')
    title Statistics Report
    link(rel='stylesheet', href='../static/css/style.css', type='text/css')
    link(rel='stylesheet', href='https://use.fontawesome.com/releases/v5.8.2/css/all.css', integrity='sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay', crossorigin='anonymous')
    link(rel='stylesheet', href='https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css')
    link(rel='shortcut icon', href='../static/favicon.ico', type='image/x-icon')
body
    h2 Statistics Report
    p.redirectTo
      b Redirect to : 
      a(href=statsObject.inputUrl)
        |  #{statsObject.inputUrl}
    .tableFormat
        table.ui.celled.green.definition.unstackable.table
            thead
                tbody
                tr
                    td Statistics for/ShortLink 
                    td  
                        a#shortlink(href=statsObject.ShortId) #{statsObject.ShortId}
                tr
                    td Created At
                    td #{statsObject.CreatedAt}
                tr
                    td Views (Redirects) 
                    td #{statsObject.views}
                tr
                    td Distinct Users 
                    td #{statsObject.distinctUsers} 
                        b
                            |  (Distinct IP Address)
                tr
                    td Generated By 
                    td 1
                tr
                    td Devices
                    td
                        b
                            | Mobile 
                            i.fas.fa-mobile
                            |  : 
                            span#mobileUsers
                            | #{statsObject.mobileUsers} , 
                        b
                            | Desktop 
                            i.fas.fa-desktop
                            |  : 
                            span#desktopUsers
                            | #{statsObject.desktopUsers}
                tr
                    td Compression Rate
                    td From #{statsObject.inputUrl.length} characters to #{statsObject.ShortId.length} characters: #{statsObject.CompressionRate}% (#{statsObject.inputUrl.length-statsObject.ShortId.length} characters) shorter!
                tr
                    td QR Code
                    td
                        img(src=statsObject.QRcode, alt='qrcode', width='120', height='120')
                        br
                        br
                        a(href=statsObject.QRcode, target='_blank') Download QR
        br
        p
            i.fas.fa-download
            |  Download Report as 
            //- a(onclick='tocsv()') csv
            //- | , 
            //- a(href='#') xlsx
            //- | , 
            a#exportJSON(onclick='exportJson(this);') json
        br
        br
        script.
            function exportJson(el) {
                var obj = {
                    inputUrl: '#{statsObject.inputUrl}',
                    CreatedAt: '#{statsObject.CreatedAt}',
                    ShortId: '#{statsObject.ShortId}',
                    CompressionRate: '#{statsObject.CompressionRate}' + '%',
                    QRcode: `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${'#{statsObject.ShortId}'}`
                };
                var data = "text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(obj));
                el.setAttribute("href", "data:"+data);
                el.setAttribute("download", "statistics.json");
            }